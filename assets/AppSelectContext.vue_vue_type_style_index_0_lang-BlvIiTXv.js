import{d as H,r as g,dR as J,dS as K,dT as O,dU as P,G as Q,c as W,F as X,g as b,l as V,f as B,m as l,cm as h,cn as $,t as F,v as T,aN as u,o as v}from"./index-DuJ21lMM.js";import{$ as S}from"./api-D3UVNwbo.js";import{V as y}from"./VSelect-BqFYC3zs.js";const _=H({__name:"AppSelectContext",props:{enableLocations:{type:Boolean,default:()=>!1},enableCustomerLists:{type:Boolean,default:()=>!1},enableCatalogs:{type:Boolean,default:()=>!1}},setup(A){const k=A,D=g(k.enableLocations),G=g(k.enableCustomerLists),E=g(k.enableCatalogs),n=J(),r=K(),o=O(),i=P(),c=g(),m=g(),d=g(),C=g();c.value=n.getCurrentLocation,m.value=r.getCurrentCustomerList,d.value=o.getCurrentCatalog,C.value=i.getCurrentVariant,i.setVariantsFromCatalog(d.value);const f=e=>{var t;typeof e=="string"&&(e=((t=r.getCustomerLists)==null?void 0:t.find(a=>a.id===e))??null),e!==null&&(r.setCurrentCustomerList(e),m.value=r.getCurrentCustomerList)},p=e=>{var t;if(typeof e=="string"&&(e=((t=o.getCatalogs)==null?void 0:t.find(a=>a.id===e))??null),e!==null){if(e.data!==void 0){o.setCurrentCatalog(e),d.value=o.getCurrentCatalog,i.setVariantsFromCatalog(d.value);return}S(`catalog?catalogId=${e.id}`,{method:"GET",onResponseError({response:a}){o.setCurrentCatalog(void 0),h(a)}}).then(a=>{o.setCurrentCatalog(a.catalog),d.value=o.getCurrentCatalog,i.setVariantsFromCatalog(d.value),e.data=a.catalog.data}).catch(a=>{o.setCurrentCatalog(void 0),$(a)})}},M=e=>{var t;typeof e=="string"&&(e=((t=i.getVariants)==null?void 0:t.find(a=>a.ref===e))??null),e!==null&&e.ref!==void 0&&(i.setCurrentVariant(e),C.value=e)},U=()=>{var e,t;E.value&&(o.getCatalogs===void 0?(o.setCatalogs(void 0),S(`catalogs?locationId=${(e=n.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:a}){h(a)}}).then(a=>{var s;o.setCatalogs(a.catalogs),((s=o.getCatalogs)==null?void 0:s.length)===1&&p(o.getCatalogs[0])}).catch(a=>{$(a)})):o.getCurrentCatalog!==void 0?p(o.getCurrentCatalog):((t=o.getCatalogs)==null?void 0:t.length)===1&&p(o.getCatalogs[0]))},w=()=>{var e,t;G.value&&(r.getCustomerLists===void 0?(r.setCustomerLists(void 0),S(`customers/list?locationId=${(e=n.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:a}){h(a)}}).then(a=>{var s;r.setCustomerLists(a.lists),((s=r.getCustomerLists)==null?void 0:s.length)===1&&f(r.getCustomerLists[0])}).catch(a=>{$(a)})):r.getCurrentCustomerList!==void 0?f(r.getCurrentCustomerList):((t=r.getCustomerLists)==null?void 0:t.length)===1&&f(r.getCustomerLists[0]))},L=e=>{var t;typeof e=="string"&&(e=((t=n.getLocations)==null?void 0:t.find(a=>a.id===e))??null),e!==null&&(e!==n.getCurrentLocation?(n.setCurrentLocation(e),c.value=n.getCurrentLocation,N(),j()):(w(),U()))},I=()=>{n.setLocations(void 0),S("locations",{method:"GET",onResponseError({response:e}){h(e)}}).then(e=>{var t;n.setLocations(e.locations),((t=n.getLocations)==null?void 0:t.length)===1&&L(n.getLocations[0])}).catch(e=>{$(e)})},z=()=>{c.value!==void 0&&(c.value=void 0),n.reset(),I()},N=()=>{m.value!==void 0&&(m.value=void 0),r.reset(),w()},q=()=>{C.value!==void 0&&(C.value=void 0),i.reset(),i.setVariantsFromCatalog(d.value??void 0)},j=()=>{d.value!==void 0&&(d.value=void 0),o.reset(),q(),U()},R=e=>typeof e!="object"||e===null?e:`${e.name} (${e.id})`;return Q(()=>{var e;D.value&&(n.getLocations===void 0?I():n.getCurrentLocation!==void 0?L(n.getCurrentLocation):((e=n.getLocations)==null?void 0:e.length)===1&&L(n.getLocations[0]))}),(e,t)=>{var a;return v(),W(X,null,[D.value?(v(),b(y,{key:0,modelValue:c.value,"onUpdate:modelValue":[t[0]||(t[0]=s=>c.value=s),L],disabled:l(n).getLocations===void 0,"item-title":R,items:l(n).getLocations,label:("$t"in e?e.$t:l(u))("page.order.add.button.location.label"),loading:l(n).getLocations===void 0,placeholder:("$t"in e?e.$t:l(u))("page.order.add.button.location.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",variant:"underlined","onClick:clear":z},{selection:B(({item:s})=>[F(T(s.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),G.value?(v(),b(y,{key:1,modelValue:m.value,"onUpdate:modelValue":[t[1]||(t[1]=s=>m.value=s),f],disabled:l(r).getCustomerLists===void 0,"item-title":R,items:l(r).getCustomerLists,label:("$t"in e?e.$t:l(u))("page.order.add.button.customerList.label"),loading:l(r).getCustomerLists===void 0,placeholder:("$t"in e?e.$t:l(u))("page.order.add.button.customerList.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",variant:"underlined","onClick:clear":N},{selection:B(({item:s})=>[F(T(s.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),E.value?(v(),b(y,{key:2,modelValue:d.value,"onUpdate:modelValue":[t[2]||(t[2]=s=>d.value=s),p],disabled:l(o).getCatalogs===void 0,"item-title":R,items:l(o).getCatalogs,label:("$t"in e?e.$t:l(u))("page.order.add.button.catalog.label"),loading:l(o).getCatalogs===void 0,placeholder:("$t"in e?e.$t:l(u))("page.order.add.button.catalog.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",variant:"underlined","onClick:clear":j},{selection:B(({item:s})=>[F(T(s.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),E.value&&((a=l(i).getVariants)==null?void 0:a.length)!==0?(v(),b(y,{key:3,modelValue:C.value,"onUpdate:modelValue":[t[3]||(t[3]=s=>C.value=s),M],disabled:l(i).getVariants===void 0,items:l(i).getVariants,label:("$t"in e?e.$t:l(u))("page.order.add.button.variant.label"),loading:l(i).getVariants===void 0,placeholder:("$t"in e?e.$t:l(u))("page.order.add.button.variant.placeholder"),clearable:"","item-title":"name","item-value":"ref","no-data-text":"common.component.noData",variant:"underlined","onClick:clear":q},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0)],64)}}});export{_};
