import{$ as u}from"./TranslationUtil-YrEf8DfR.js";import{b as H,d as J,e as K,f as O,h as b,a as V}from"./Http-rpOQvG1V.js";import{$ as h}from"./api-BT_gBHvz.js";import{V as $}from"./VSelect-CoX1IbLv.js";import{d as P,r as g,G as Q,c as W,F as X,g as S,l as y,f as B,m as l,t as F,v as D,o as v}from"./index-CiwEqhLZ.js";const te=P({__name:"AppSelectContext",props:{enableLocations:{type:Boolean,default:()=>!1},enableCustomerLists:{type:Boolean,default:()=>!1},enableCatalogs:{type:Boolean,default:()=>!1}},setup(A){const k=A,G=g(k.enableLocations),T=g(k.enableCustomerLists),E=g(k.enableCatalogs),n=H(),r=J(),o=K(),i=O(),m=g(),c=g(),d=g(),C=g();m.value=n.getCurrentLocation,c.value=r.getCurrentCustomerList,d.value=o.getCurrentCatalog,C.value=i.getCurrentVariant,i.setVariantsFromCatalog(d.value);const f=e=>{var t;typeof e=="string"&&(e=((t=r.getCustomerLists)==null?void 0:t.find(a=>a.id===e))??null),e!==null&&(r.setCurrentCustomerList(e),c.value=r.getCurrentCustomerList)},p=e=>{var t;if(typeof e=="string"&&(e=((t=o.getCatalogs)==null?void 0:t.find(a=>a.id===e))??null),e!==null){if(e.data!==void 0){o.setCurrentCatalog(e),d.value=o.getCurrentCatalog,i.setVariantsFromCatalog(d.value);return}h(`catalog?catalogId=${e.id}`,{method:"GET",onResponseError({response:a}){o.setCurrentCatalog(void 0),b(a)}}).then(a=>{o.setCurrentCatalog(a.catalog),d.value=o.getCurrentCatalog,i.setVariantsFromCatalog(d.value),e.data=a.catalog.data}).catch(a=>{o.setCurrentCatalog(void 0),V(a)})}},M=e=>{var t;typeof e=="string"&&(e=((t=i.getVariants)==null?void 0:t.find(a=>a.ref===e))??null),e!==null&&e.ref!==void 0&&(i.setCurrentVariant(e),C.value=e)},w=()=>{var e,t;E.value&&(o.getCatalogs===void 0?(o.setCatalogs(void 0),h(`catalogs?locationId=${(e=n.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:a}){b(a)}}).then(a=>{var s;o.setCatalogs(a.catalogs),((s=o.getCatalogs)==null?void 0:s.length)===1&&p(o.getCatalogs[0])}).catch(a=>{V(a)})):o.getCurrentCatalog!==void 0?p(o.getCurrentCatalog):((t=o.getCatalogs)==null?void 0:t.length)===1&&p(o.getCatalogs[0]))},I=()=>{var e,t;T.value&&(r.getCustomerLists===void 0?(r.setCustomerLists(void 0),h(`customers/list?locationId=${(e=n.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:a}){b(a)}}).then(a=>{var s;r.setCustomerLists(a.lists),((s=r.getCustomerLists)==null?void 0:s.length)===1&&f(r.getCustomerLists[0])}).catch(a=>{V(a)})):r.getCurrentCustomerList!==void 0?f(r.getCurrentCustomerList):((t=r.getCustomerLists)==null?void 0:t.length)===1&&f(r.getCustomerLists[0]))},L=e=>{var t;typeof e=="string"&&(e=((t=n.getLocations)==null?void 0:t.find(a=>a.id===e))??null),e!==null&&(e!==n.getCurrentLocation?(n.setCurrentLocation(e),m.value=n.getCurrentLocation,q(),j()):(I(),w()))},U=()=>{n.setLocations(void 0),h("locations",{method:"GET",onResponseError({response:e}){b(e)}}).then(e=>{var t;n.setLocations(e.locations),((t=n.getLocations)==null?void 0:t.length)===1&&L(n.getLocations[0])}).catch(e=>{V(e)})},z=()=>{m.value!==void 0&&(m.value=void 0),n.reset(),U()},q=()=>{c.value!==void 0&&(c.value=void 0),r.reset(),I()},N=()=>{C.value!==void 0&&(C.value=void 0),i.reset(),i.setVariantsFromCatalog(d.value??void 0)},j=()=>{d.value!==void 0&&(d.value=void 0),o.reset(),N(),w()},R=e=>typeof e!="object"||e===null?e:`${e.name} (${e.id})`;return Q(()=>{var e;G.value&&(n.getLocations===void 0?U():n.getCurrentLocation!==void 0?L(n.getCurrentLocation):((e=n.getLocations)==null?void 0:e.length)===1&&L(n.getLocations[0]))}),(e,t)=>{var a;return v(),W(X,null,[G.value?(v(),S($,{key:0,modelValue:m.value,"onUpdate:modelValue":[t[0]||(t[0]=s=>m.value=s),L],disabled:l(n).getLocations===void 0,"item-title":R,items:l(n).getLocations,label:("$t"in e?e.$t:l(u))("page.order.add.button.location.label"),loading:l(n).getLocations===void 0,placeholder:("$t"in e?e.$t:l(u))("page.order.add.button.location.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",variant:"underlined","onClick:clear":z},{selection:B(({item:s})=>[F(D(s.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):y("",!0),T.value?(v(),S($,{key:1,modelValue:c.value,"onUpdate:modelValue":[t[1]||(t[1]=s=>c.value=s),f],disabled:l(r).getCustomerLists===void 0,"item-title":R,items:l(r).getCustomerLists,label:("$t"in e?e.$t:l(u))("page.order.add.button.customerList.label"),loading:l(r).getCustomerLists===void 0,placeholder:("$t"in e?e.$t:l(u))("page.order.add.button.customerList.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",variant:"underlined","onClick:clear":q},{selection:B(({item:s})=>[F(D(s.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):y("",!0),E.value?(v(),S($,{key:2,modelValue:d.value,"onUpdate:modelValue":[t[2]||(t[2]=s=>d.value=s),p],disabled:l(o).getCatalogs===void 0,"item-title":R,items:l(o).getCatalogs,label:("$t"in e?e.$t:l(u))("page.order.add.button.catalog.label"),loading:l(o).getCatalogs===void 0,placeholder:("$t"in e?e.$t:l(u))("page.order.add.button.catalog.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",variant:"underlined","onClick:clear":j},{selection:B(({item:s})=>[F(D(s.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):y("",!0),E.value&&((a=l(i).getVariants)==null?void 0:a.length)!==0?(v(),S($,{key:3,modelValue:C.value,"onUpdate:modelValue":[t[3]||(t[3]=s=>C.value=s),M],disabled:l(i).getVariants===void 0,items:l(i).getVariants,label:("$t"in e?e.$t:l(u))("page.order.add.button.variant.label"),loading:l(i).getVariants===void 0,placeholder:("$t"in e?e.$t:l(u))("page.order.add.button.variant.placeholder"),clearable:"","item-title":"name","item-value":"ref","no-data-text":"common.component.noData",variant:"underlined","onClick:clear":N},null,8,["modelValue","disabled","items","label","loading","placeholder"])):y("",!0)],64)}}});export{te as _};
