import{d as I,aN as t,r as x,dR as T,G as D,aj as V,c as k,b as s,f as a,m as i,cm as C,cn as H,o as E,e as l,v as n,aX as R,t as _,$ as L}from"./index-DuJ21lMM.js";import{d as N}from"./PriceUtil-qNSdq12I.js";import{D as u,d as A}from"./DateUtil-C9HnsOvZ.js";import{_ as P}from"./AppSelectContext.vue_vue_type_style_index_0_lang-BlvIiTXv.js";import{_ as U}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-CCSqo9O5.js";import{c as o}from"./common-api.web.min-DozRe4br.js";import{u as q}from"./usePageTitle-CeqFxl02.js";import B from"./card-order-details-C_y9gNzr.js";import{$ as Y}from"./api-D3UVNwbo.js";import{V as j,a as b}from"./VRow-DGRt7Q0q.js";import{V as z}from"./VDataTable-DYiuGgFO.js";import{V as G}from"./VChip-CJSEhb1l.js";import{V as Z}from"./VAvatar-BOqjaZeG.js";import"./VSelect-BqFYC3zs.js";import"./VTextField-1vKVJPA6.js";/* empty css                   */import"./VCounter-Dvf9surC.js";import"./transition-BdhdVM5b.js";import"./VField-B4K-hbyz.js";import"./form-Dh1pAnEr.js";import"./easing-Bybner-F.js";import"./VInput-DoueL37O.js";import"./forwardRefs-C-GTDzx5.js";import"./index-DwikAHxr.js";import"./VList-C4wVJxYD.js";import"./ssrBoot-DfLcOF0D.js";import"./VDivider-C_C-az4b.js";import"./dialog-transition-BOq2AdcK.js";import"./VMenu-ym7dAu5B.js";import"./VOverlay-Bl3HSHDt.js";import"./delay-Cnyh4D82.js";import"./lazy-TMlza-YJ.js";import"./scopeId-DO_PNyih.js";import"./VCheckboxBtn-QWsUU3Bb.js";import"./VSelectionControl-BO-swwm2.js";import"./VCard-C7nUahwm.js";import"./VCardText-B4rK-kDH.js";import"./VImg-VuumHQE6.js";import"./VTable-CmRGJZHP.js";import"./VAlert-DR70Nr4t.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSlideGroup-BRN6LOuW.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VPagination-CPdP8FFZ.js";import"./filter-DYiXZttm.js";const F={class:"text-h4 mb-1"},M={class:"text-body-1"},X={class:"v-data-table__tr"},J=["colspan"],K={class:"d-flex align-center"},Q={class:"d-flex flex-column ms-3"},W={class:"d-flex align-center"},Fe=I({__name:"list",setup(ee){const w=u.local().toISODate(),O=[{key:"data-table-expand",title:""},{key:"service_type",title:t("page.order.list.header.serviceType")},{key:"ref",title:t("page.order.list.header.reference")},{key:"channel",title:t("page.order.list.header.channel")},{key:"expected_time",title:t("page.order.list.header.expectedTime")},{key:"total",title:t("page.order.list.header.total")},{key:"status",title:t("page.order.list.header.status")},{key:"created_at",title:t("page.order.list.header.createdAt")}],d=x(),g=x(`${u.local().toISODate()} > ${u.local().toISODate()}`),m=x(!1),v=e=>{switch(e){case o.Api.HubriseServiceType.DELIVERY:return{icon:"bx-cycling ",color:"info",text:t("page.order.list.serviceType.delivery")};case o.Api.HubriseServiceType.COLLECTION:return{icon:"bx-shopping-bag",color:"info",text:t("page.order.list.serviceType.pickup")};case o.Api.HubriseServiceType.EAT_IN:return{icon:"bx-table",color:"info",text:t("page.order.list.serviceType.eatIn")}}return{icon:"bx-question-mark",color:"error",text:t("page.order.list.serviceType.unknown")}},$=e=>{switch(e){case o.Api.HubriseOrderStatus.new:return{color:"info",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.received:return{color:"info",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.accepted:return{color:"info",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.in_preparation:return{color:"warning",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.awaiting_shipment:return{color:"warning",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.awaiting_collection:return{color:"warning",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.in_delivery:return{color:"warning",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.completed:return{color:"success",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.rejected:return{color:"error",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.cancelled:return{color:"error",text:t(`page.order.list.status.${String(e)}`)};case o.Api.HubriseOrderStatus.delivery_failed:return{color:"error",text:t(`page.order.list.status.${String(e)}`)}}return{color:"error",text:t("page.order.list.status.unknown")}},h=()=>{const e=y.getCurrentLocation;if(typeof(e==null?void 0:e.id)!="string"){d.value=void 0;return}const c=g.value.split(">").map(p=>p.trim()),f=u.fromISO(c[0],{setZone:!0}).set({hour:0,minute:0,second:0,millisecond:0}).toISO(),S=u.fromISO(c[1]??c[0],{setZone:!0}).set({hour:23,minute:59,second:59,millisecond:999}).toISO(),r=new URLSearchParams;r.append("locationId",e.id),typeof f=="string"&&r.append("startDate",encodeURIComponent(f)),typeof S=="string"&&r.append("endDate",encodeURIComponent(S)),m.value=!0,Y(`orderpad/orders?${r.toString()}`,{method:"GET",onResponseError({response:p}){d.value=[],m.value=!1,C(p)}}).then(p=>{d.value=p.orders,m.value=!1}).catch(p=>{d.value=[],m.value=!1,H(p)})},y=T();return D(()=>{q("page.order.list.title"),y.onCurrentLocationChange(h)}),V(()=>{y.offCurrentLocationChange(h)}),(e,c)=>{const f=U,S=P;return E(),k("div",null,[s(j,{class:"mb-3"},{default:a(()=>[s(b,{class:"d-flex gap-4 align-end flex-wrap",cols:"3"},{default:a(()=>[l("h4",F,n(("$t"in e?e.$t:i(t))("page.order.list.title")),1),l("div",M,n(("$t"in e?e.$t:i(t))("page.order.add.subtitle")),1)]),_:1}),s(b,{class:"d-inline-flex gap-4 align-end overflow-hidden",cols:"6"},{default:a(()=>[s(f,{modelValue:i(g),"onUpdate:modelValue":[c[0]||(c[0]=r=>R(g)?g.value=r:null),h],config:{mode:"single",enableTime:!1,noCalendar:!1,dateFormat:"Y-m-d",maxDate:i(w)},label:("$t"in e?e.$t:i(t))("page.order.list.selector.date.label"),clearable:"",style:{width:"250px"},variant:"underlined"},null,8,["modelValue","config","label"])]),_:1}),s(b,{class:"d-flex gap-4 align-end flex-wrap",cols:"3"},{default:a(()=>[s(S,{"enable-locations":""})]),_:1})]),_:1}),s(z,{headers:O,items:i(d),"items-per-page":100,loading:i(m)||i(d)===void 0,"expand-on-click":"","fixed-header":"","hide-default-footer":"","loading-text":"common.component.loading","no-data-text":"common.component.noData"},{"expanded-row":a(r=>[l("tr",X,[l("td",{colspan:O.length,class:"pa-0"},[s(B,{order:r.item},null,8,["order"])],8,J)])]),"item.service_type":a(({item:r})=>[l("div",K,[s(Z,{color:v(r.service_type).color,size:"32",variant:"tonal"},{default:a(()=>[s(L,{icon:v(r.service_type).icon,class:"font-weight-medium"},null,8,["icon"])]),_:2},1032,["color"]),l("div",Q,[l("small",null,n(v(r.service_type).text),1)])])]),"item.ref":a(({item:r})=>[l("div",W,n(r.ref)+n(r.private_ref),1)]),"item.total":a(({item:r})=>[_(n(("displayPrice"in e?e.displayPrice:i(N))(r.total)),1)]),"item.status":a(({item:r})=>[s(G,{color:$(r.status).color,class:"font-weight-medium text-uppercase",size:"small"},{default:a(()=>[_(n($(r.status).text),1)]),_:2},1032,["color"])]),"item.expected_time":a(({item:r})=>[_(n(("displayISO"in e?e.displayISO:i(A))(r.expected_time)||("$t"in e?e.$t:i(t))("page.order.list.asap")),1)]),"item.created_at":a(({item:r})=>[_(n(("displayISO"in e?e.displayISO:i(A))(r.created_at)),1)]),_:1},8,["items","loading"])])}}});export{Fe as default};
