import"./validators-BJEf8OaU.js";import{_ as F}from"./AppTextField.vue_vue_type_script_setup_true_lang-vJGedwOa.js";import{u as S,_ as P,a as D}from"./useAbility-CStnHOlT.js";import{a as L,b as j}from"./auth-v1-top-shape-0NcaQZ_m.js";import{V as _}from"./VNodeRenderer-fBlyALcd.js";import{d as E,r as m,u as U,j as M,b3 as r,bb as H,a$ as k,a as I,c as O,o as f,g,l as V,e as s,m as t,b as o,L as N,f as l,H as h,v as A,t as T,x as z,F as G,dw as x}from"./index-CiwEqhLZ.js";import{$ as K}from"./api-BT_gBHvz.js";import{c as W}from"./Http-rpOQvG1V.js";import{a as X,c as Y,V as J}from"./VCard-gZi5h7Mn.js";import{V as B}from"./VCardText-Yc2P1elE.js";import"./VRow-C1bIydfl.js";import"./VCheckbox-YcmwAIja.js";import"./VDivider-BoI1Jorv.js";import"./helpers-BGv4x_9E.js";import"./VTextField-DWvVicwF.js";/* empty css                   */import"./VCounter-MxZMDOkS.js";import"./transition-eea-r_dM.js";import"./VField-B-BxNMBp.js";import"./form-BE-U9JRN.js";import"./easing-Bybner-F.js";import"./VInput-DixHD0vu.js";import"./forwardRefs-C-GTDzx5.js";import"./index-BEffH-28.js";import"./account-DvQtffyR.js";import"./mitt-DJ65BbbF.js";import"./alert-CIf1_c1a.js";import"./TranslationUtil-YrEf8DfR.js";import"./index-CvOPxmL5.js";import"./VAvatar-CIDNK3Hm.js";import"./VImg-BnyIunqW.js";/* empty css              */import"./VCheckboxBtn-BOJMNfo6.js";import"./VSelectionControl-BHVfrwTk.js";const Q={class:"auth-wrapper d-flex align-center justify-center pa-4"},Z={class:"position-relative my-sm-16"},ee={class:"app-logo"},ae={class:"app-logo-title"},te={class:"text-h4 mb-1"},oe={class:"text-capitalize"};const Xe=E({__name:"login",async setup(re){let b,w;const se=m(!1),n=U(),y=M(),v=S(),R=m({email:void 0,password:void 0}),$=m(),C=m({email:"",password:"",remember:!1}),q=async()=>{try{const e=await K("/auth/login",{method:"POST",body:{email:C.value.email,password:C.value.password},onResponseError({response:p}){R.value=p._data.errors}}),{accessToken:a,userData:i,userAbilityRules:d}=e;r("userAbilityRules",{maxAge:x}).value=d,v.update(d),r("userData",{maxAge:x}).value=i,r("accessToken",{maxAge:x}).value=a,await k(()=>{y.replace(n.query.to?String(n.query.to):"/")})}catch(e){console.error(e)}},le=()=>{var e;(e=$.value)==null||e.validate().then(({valid:a})=>{a&&q()})},c=r("jwt",{domain:".apps.onylab.com"}).value;if(typeof c=="string"){W();const e=c,a=[{action:"manage",subject:"all"}],i={id:1,fullName:"",username:"",avatar:void 0,email:"",role:"admin"};r("userAbilityRules").value=a,v.update(a),r("userData").value=i,r("accessToken").value=e,[b,w]=H(()=>k(()=>{y.replace(n.query.to?String(n.query.to):"/")})),await b,w()}else window.location.href="https://login.apps.onylab.com/auth/?app=orderpad";return(e,a)=>{const i=P,d=D,p=I("RouterLink"),ie=F;return f(),O(G,null,[t(c)?(f(),g(i,{key:0})):V("",!0),t(c)?(f(),g(d,{key:1})):V("",!0),s("div",Q,[s("div",Z,[o(t(_),{nodes:("h"in e?e.h:t(N))("div",{innerHTML:t(L)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),o(t(_),{nodes:("h"in e?e.h:t(N))("div",{innerHTML:t(j)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),o(J,{class:z([e.$vuetify.display.smAndUp?"pa-6":"pa-0","auth-card"]),"max-width":"460"},{default:l(()=>[o(X,{class:"justify-center"},{default:l(()=>[o(Y,null,{default:l(()=>[o(p,{to:"/"},{default:l(()=>[s("div",ee,[o(t(_),{nodes:t(h).app.logo},null,8,["nodes"]),s("h1",ae,A(t(h).app.title),1)])]),_:1})]),_:1})]),_:1}),o(B,null,{default:l(()=>[s("h4",te,[a[4]||(a[4]=T(" Welcome to ")),s("span",oe,A(t(h).app.title),1),a[5]||(a[5]=T("! ðŸ‘‹ðŸ» "))]),a[6]||(a[6]=s("p",{class:"mb-0"},null,-1))]),_:1,__:[6]}),o(B,null,{default:l(()=>[V("",!0)]),_:1})]),_:1},8,["class"])])])],64)}}});export{Xe as default};
