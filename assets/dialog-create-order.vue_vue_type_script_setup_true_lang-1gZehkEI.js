import{d as I,dR as O,dS as B,r as g,w as E,g as c,f as i,m as t,aX as T,o as u,l as m,b as f,aN as d,bc as j,t as y,v as C,ai as h,b8 as k,cm as q,cn as P}from"./index-BZ3aEYCE.js";import{_ as U}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-Cm78PSz6.js";import{$ as X}from"./api-DRZdxBXL.js";import{V as z}from"./VDialog-DgzRZurq.js";import{V as F}from"./VCard-CFHeageg.js";import{V}from"./VCardText-DtWLqdWo.js";const W=I({__name:"dialog-create-order",props:{order:{type:Object,default:()=>{}}},emits:["done"],setup(w,{emit:S}){const $=w,N=S,_=O(),A=B(),b=g({}),n=g(!1),r=g(!0),p=e=>{e===void 0?n.value=!1:b.value=e,r.value=!1,N("done")},R=e=>{Array.isArray(e.items)&&(e.items=e.items.filter(o=>{var s;return o.options=(s=o.options)==null?void 0:s.filter(a=>"id"in a&&a.id!==void 0&&a.id!==null),"id"in o&&o.id!==void 0&&o.id!==null}))},D=e=>{var a,L;const o=(a=_.getCurrentLocation)==null?void 0:a.id;if(o===void 0){k().setAlert({title:d("page.order.add.section.create.error.locationNotDefined")});return}const s=(L=A.getCurrentCustomerList)==null?void 0:L.id;if(s===void 0){k().setAlert({title:d("page.order.add.section.create.error.customerListNotDefined")});return}r.value=!0,R(e),X("orderpad/order",{method:"POST",body:{locationId:o,customerListId:s,...e},onResponseError({response:l}){q(l),p()}}).then(l=>{p(l.order)}).catch(l=>{P(l),p()})},v=()=>{n.value=!1,r.value=!1,window.location.reload()};return E(()=>$.order,()=>{n.value=!0,r.value=!0,D($.order)}),(e,o)=>{const s=U;return u(),c(z,{modelValue:t(n),"onUpdate:modelValue":o[0]||(o[0]=a=>T(n)?n.value=a:null),persistent:t(r),class:"v-dialog-sm","onClick:outside":v},{default:i(()=>[t(r)?m("",!0):(u(),c(s,{key:0,onClick:v})),f(F,{color:t(r)?"primary":"white",title:t(r)?("$t"in e?e.$t:t(d))("page.order.add.section.create.creating.title"):("$t"in e?e.$t:t(d))("page.order.add.section.create.created.title")},{default:i(()=>[t(r)?(u(),c(V,{key:0,class:"pt-3 text-white"},{default:i(()=>[f(j,{"bg-color":"rgba(var(--v-theme-surface), 0.1)",class:"mb-0 mt-4",color:"#fff",indeterminate:""})]),_:1})):m("",!0),t(r)?m("",!0):(u(),c(V,{key:1},{default:i(()=>[y(C(("$t"in e?e.$t:t(d))("page.order.add.section.create.created.description",{orderName:t(b).ref})),1)]),_:1})),t(r)?m("",!0):(u(),c(V,{key:2,class:"d-flex justify-end gap-3 flex-wrap"},{default:i(()=>[f(h,{to:{name:"order-list"},color:"secondary",variant:"tonal"},{default:i(()=>[y(C(("$t"in e?e.$t:t(d))("page.order.add.section.create.button.orders")),1)]),_:1}),f(h,{onClick:v},{default:i(()=>[y(C(("$t"in e?e.$t:t(d))("page.order.add.section.create.button.validate")),1)]),_:1})]),_:1}))]),_:1},8,["color","title"])]),_:1},8,["modelValue","persistent"])}}});export{W as _};
